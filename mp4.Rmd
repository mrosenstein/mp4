---
title: "mp4"
author: "Qiuzi Chen,  Yuri Furukawa, Mae Roesenstein"
date: "4/24/2018"
output: html_document
---

```{r}
library(mdsr)
library(RMySQL)
library(stringr)
db <- dbConnect_scidb(dbname = "airlines")


dbListTables(db)
dbListFields(db, "flights")
dbListFields(db, "weather")
```

```{r}
db_flights <- db %>%
  dbGetQuery("SELECT f.cancelled, f.dep_delay,
                     CONCAT(f.year,'-0',f.month,'-',f.day,' ',f.hour,':00') AS date
              FROM flights f
              WHERE year = 2013
              AND month = 1;")

db_weather <- db %>%
  dbGetQuery("SELECT year, month, SUBSTRING_INDEX(date, ':', 2) AS new_date, w.precip, w.wind_speed
              FROM weather w
              WHERE year = 2013
              AND month = 1;")

db %>%
  dbGetQuery("SELECT CONCAT(f.year,'-',f.month,'-',f.day,' ',f.hour,':00') AS f_date,
                     SUBSTRING_INDEX(w.date, ':', 2) AS w_date,
                     f.cancelled, f.dep_delay, w.precip, w.wind_speed
              FROM flights f
              JOIN weather w ON w_date = f_date;")
```